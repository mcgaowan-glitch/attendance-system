<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>雲端簽到</title>
</head>

<body>

<h2>雲端簽到系統</h2>

<input id="name" placeholder="輸入姓名">
<button onclick="signin()">簽到</button>

<ul id="list"></ul>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
import { getDatabase, ref, push, onValue } 
from "https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyACpUi6HAfPZueC-NHNbno-14ZepQ33U50",
  authDomain: "attendance-f20a7.firebaseapp.com",
  databaseURL: "https://attendance-f20a7-default-rtdb.firebaseio.com",
  projectId: "attendance-f20a7",
  storageBucket: "attendance-f20a7.firebasestorage.app",
  messagingSenderId: "1066917565778",
  appId: "1:1066917565778:web:6dacfdf248f85bb290168b",
  measurementId: "G-LGNCFVBR0G"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

window.signin = function(){
  const name = document.getElementById("name").value;
  if(!name) return;

  push(ref(db,"attendance"),{
    name:name,
    time:new Date().toLocaleString()
  });

  document.getElementById("name").value="";
};

function loadData(){
  const list = document.getElementById("list");

  onValue(ref(db,"attendance"),(snapshot)=>{
    list.innerHTML="";
    snapshot.forEach(child=>{
      const d = child.val();
      list.innerHTML += `<li>${d.name} - ${d.time}</li>`;
    });
  });
}

loadData();

</script>

</body>
</html>
